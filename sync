#! /bin/bash
set -e

cd $(dirname $0)

syncfiles="bashrc emacs gitconfig screenrc vimrc zshrc"
for dotfilename in $syncfiles; do
  srcname="$PWD/$dotfilename"
  dstname="$HOME/.$dotfilename"

  echo "${dstname}:"

  if [[ -h "$dstname" ]]; then
    echo -en "\tRemoving ... "
    \rm -- "${dstname}" && echo "[OK] "
  elif [[ -e "$dstname" ]]; then
    echo -en "\tMoving to ${dstname}.backup.$(date -I) ... "
    \mv -- "${dstname}" "${dstname}.backup.$(date -I)" && echo "[OK]"
  fi
  echo -en "\tSymlinking -> ${srcname} ... "
  \ln -s -- "${srcname}" "${dstname}"
  echo "[OK]"
done

if [[ ! -f $HOME/.bash_profile ]]; then
  echo "source .bashrc" >> $HOME/.bash_profile
fi

cd - >/dev/null

